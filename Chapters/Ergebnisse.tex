\chapter{Beschreibung der verschiedenen Messungen und Ergebnisdarstellung}

\section{Teil 1}


\subsection{Konfiguration der Hosts}\label{hostconfig}
Die Hosts werden nach den Vorgaben in \ref{config1} konfiguriert. Host 1 wird an
den Port Fa0/11 angeschlossen, Host 2 an Fa0/18. Host 3 wird nicht
verbunden.\footnote{siehe Versuchsanleitung}

\subsection{Konfiguration des Router}\label{routerconfig}
Der Router wird an den Port Fa0/5 des Switches angeschlossen und konfiguriert.
Die Konfiguration beinhaltet die Änderung des Hostnames in ``CustomerRouter'',
die Konfiguration und Aktivierung der Passwörter und die Konfiguration der
Fa0/1-Schnittstelle:
\begin{lstlisting}
CustomerRouter(config-if)#line console 0
CustomerRouter(config-line)#password cisco
CustomerRouter(config-line)#login
CustomerRouter(config-line)#exit
CustomerRouter(config)#line vty 0 4
CustomerRouter(config-line)#password cisco
CustomerRouter(config-line)#login
CustomerRouter(config-line)#exit
CustomerRouter(config)#enable password cisco
CustomerRouter(config)#enable secret class
CustomerRouter(config)#exit
\end{lstlisting}

\subsection{Konfiguration des Switch}
Die Konfiguration des Switches erfolgt analog zu \ref{routerconfig}. Das
Passwort für den Priviledge EXEC Mode lautet ``cisco123''. Das gleiche Passwort
wird auch für die Konsole und für die \acs{VTY}-Ports (Telnet Ports)
verwendet.\footnote{siehe Versuchsanleitung}

\subsubsection{Konfiguration des Management-Interfaces von VLAN1}
Um die Schnittslelle von VLAN 1 zu konfigurieren, wird im Configuration-Mode der
Befehl ``\textit{interface vlan 1}'' genutzt. Dann wird die IP-Adresse und das
Default-Gateway konfiguriert.

\subsubsection{Konfiguration überprüfen}
Zunächst wird durch ``\textit{show running-config}'' die aktuelle Konfiguration
ausgegeben. Nach einer Kontrolle wird die Konfiguration gesichert, durch das
Kopieren der running-config in die startup-config.
\newline
\newline
Um die Verbindung zu testen, werden Ping- und Telnet-Befehle genutzt.
\begin{itemize}
  	\item Pings
  	\begin{itemize}
    	\item Switch -> Router (192.168.1.1)
    	\item Host 1 -> Switch (192.168.1.5)
    \end{itemize}
\end{itemize}
Beides verlief erfolgreich.\footnote{siehe Anhang \ref{ping1}}
\paragraph{Telnet-Session}\mbox{}\\
Zunächst wird von Host 1 eine Telnet-Session zum Switch-Management VLAN 1
eröffnet:

\begin{lstlisting}
PC>telnet 192.168.1.5
Trying 192.168.1.5 ...Open
\end{lstlisting}

Nach Eingabe des zuvor konfigurierten Passworts (cisco123) ist der Zugriff auf
den Switch möglich. Mit \textit{show version} erhält man Informationen über die
Version der Software des Switches.

\begin{lstlisting}
CustomerSwitch>show version
Cisco IOS Software, C2960 Software (C2960-LANBASE-M), Version 12.2(25)FX, RELEASE SOFTWARE (fc1)
Copyright (c) 1986-2005 by Cisco Systems, Inc.
Compiled Wed 12-Oct-05 22:05 by pt_team

[...]
\end{lstlisting}

Auf dem Switch läuft die Cisco IOS Version 12.2(25)FX.
\newline
\newline
Die vollständige Ausgabe ist im Anhang unter \ref{version} zu finden.

\subsection{MAC-Addressen}

\subsubsection{Hostadressen}\label{adressen}
Um die Layer-2-Adressen der Hosts festzustellen, wird auf jedem Host mit der
Eingabeaufforderung \textit{ipconfig /all} ausgeführt.\footnote{siehe Anhang
\ref{mac}}
\begin{itemize}
  \item Host 1: 0001.C75A.60C4
  \item Host 2: 0090.21A7.1539
  \item Host 3: 0009.7C58.7137
\end{itemize}

\subsubsection{MAC-Adressen-Tabelle}
Mit \textit{show mac-address-table} werden die MAC-Adressen aufgelistet, die dem
Switch zu diesem Zeitpunkt bekannt sind.

\begin{lstlisting}
CustomerSwitch>show mac-address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0001.42a4.0002    DYNAMIC     Fa0/5
   1    0001.c75a.60c4    DYNAMIC     Fa0/11
\end{lstlisting}
Dem Switch sind nur zwei dynamische Adressen bekannt. Die erste entspricht der
Adresse von Host 1 am Port Fa0/11.

\subsubsection{Statische MAC-Adresse}
Die aus \ref{adressen} bekannte MAC-Adresse von Host 2 wird nun statisch der
Tabelle des Switches hinzugefügt:

\begin{lstlisting}
CustomerSwitch(config)#mac-address-table static 0090.21A7.1539 vlan 1 interface
fastEthernet 0/18
\end{lstlisting}

Eine erneute Ausgabe der MAC-Adressen-Tabelle zeigt, dass dem Switch nun zwei
Adressen, eine dynamische und eine statische, bekannt sind.

\begin{lstlisting}
CustomerSwitch#show mac-address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0001.42a4.0002    DYNAMIC     Fa0/5
   1    0090.21a7.1539    STATIC      Fa0/18

---------------------------------------------
\end{lstlisting}

Die Adresse von Host 1 wird nicht mehr in der Tabelle aufgeführt. Die Aging-Time
beträgt standardmäßig 300 Sekunden. Nach dieser Zeit wird der Eintrag
gelöscht.\cite{cisco1}

%TODO andere MAC-Adresse?

\subsection{Geschwindigkeit und Duplex}
Zunächst werden die aktuellen Einstellungen der jewiligen Ports mit \textit{show
interfaces} ausgegeben:\footnote{siehe Anhang \ref{duplex}}
\begin{lstlisting}
Full-duplex, 100Mb/s
\end{lstlisting}
Diese Einstellung liegt bei den Ports Fa0/5, Fa0/11 und Fa0/18 vor.

\subsubsection{Änderungen am Port Fa0/5}
Über das \acs{CLI} des Switchs wird nun die Geschwindikeit auf 10Mb/s bei
Half-Duplex geändert.\footnote{siehe Versuchsanleitung}
\newline
Die erneute Ausgabe von \textit{show interfaces} zeigt, dass die Änderung
erfolgreich war:
\begin{lstlisting}
FastEthernet0/5 is up, line protocol is up (connected)
  Hardware is Lance, address is 0002.17c2.8305 (bia 0002.17c2.8305)
 BW 10000 Kbit, DLY 1000 usec,
     reliability 255/255, txload 1/255, rxload 1/255
  Encapsulation ARPA, loopback not set
  Keepalive set (10 sec)
  Half-duplex, 10Mb/s
  
  [...]
\end{lstlisting}

\subsection{Reflection}
%Fragen beantworten

\clearpage

\section{Teil 2}


\subsection{Theorie}
\subsubsection{Einsatz von Switches}
Ein Switch ist ein Kopplungselement, das mehrere Hosts in einem Netzwerk 
miteinander verbindet. In einem Ethernet-Netzwerk, das auf der Stern-Topologie
basiert dient z.B. ein Switch als Verteiler für die Datenpakete.
\subsubsection{VLAN}
Um den Begriff VLAN zu verstehen werden im folgenden zwei grundlegende Begriffe
erklärt:
\newline
\newline
Broadcast(-domain):
\newline
Sendet ein Gerät einen Broadcast, erhalten ihn alle anderen Geräte der Broadcastdomain.
\newline
\newline
LAN (Local Area Network):
\newline
Schließt alle Geräte der gleichen Broadcastdomain ein. LAN = Broadcastdomain.
Wenn man diese beiden Begriffe verstanden hat lässt sich VLAN sehr leicht erklären.
VLAN ermöglicht die Segmentierung des LAN in verschiedene Broadcastdomains durch
Separation von Ports. Solch eine individuelle Broadcastdomain nennt man Virtuelle LAN.
\newline
\newline
Vorteile:
\begin{itemize}
\item Broadcast nur in eigenen VLAN
\item Gruppierung von Nutzern pro Organisationseinheit
\item Isolation von sensiblen Daten
\item Trennung von wichtigen zu unwichtigen Diensten
\end{itemize}

Gründe für den Einsatz:
\begin{itemize}
\item Flexibleres Design bei der Gruppierung von Nutzern
\item Segmentierung von Geräten in kleinere LANs zur Reduktion von Overhead
\item Reduzierung der Größe des Spanning-Tree-Algorithmus
\item Steigerung der Sicherung
\item Trennung von Anwendungen -> QoS
\end{itemize}

Folien Vogt S.342 - 345

\subsubsection{Zuordnung eines Teilnehmers}
\subsubsection{Trunking}
Mit einer Trunk-Leitung lassen sich Switches untereinander verbinden. 
Sie koppeln Netzwerke miteinander und ermöglichen den Aufbau von LANs über 
mehrere Lokationen hinweg. Das lokale Netzwerk ist nicht mehr auf einen 
einzelnen physikalischen Switch begrenzt, sondern erstreckt sich über
mehrere Switches. Kommt VLAN-Trunking zum Einsatz, sind über einzelne 
Trunks auch die Informationen zu verschiedenen virtuellen lokalen Netzwerken 
übertragbar. Die Trunk-Verbindung kann aus einer einzigen Leitung oder aus einem Bündel von 
Leitungen bestehen. Durch das Bündeln von Leitungen erhöht sich die Bandbreite 
der Kopplung. Trunking nutzt ein zusätzliches Tag im Ethernetheader (VLAN Tagging)
Das Tag enthält eine VLAN ID zur Differenzierung verschiedener VLAN.

% https://www.ip-insider.de/was-ist-ein-vlan-trunk-a-623319/ %
\subsubsection{Spanning Tree Protokoll}

STP (IEEE 802.1D, veraltet) ist ein:
\begin{itemize}
\item Protokoll zur Pfadoptimierung,
\item Schaffung schleifenfreier Strukturen,
\item Beliebige physikalische Topologie wird zu logischer Baumtopologi
\end{itemize}

Vorgehen:
\begin{itemize}
\item Es wird eine Root Brige festgelegt
\item Jeder Switch prüft seine Ports
\item Danach wird entschieden welcher Zustnad welcher Port hat
\item Tauschen Informationen über BPDU’s (Bridge Protocol Data Unit) aus
\item Organisation der Switches dauert max. 50 Sekunden
\end{itemize}
%TODO Bild einfügen Vogt S.353 %

RSTP – Rapid STP, IEEE 802.1w
\begin{itemize}
\item Organisationszeit in der Regel in 6 Sekunden
\item Neue Rollen
\end{itemize}
Alternate Ports: blockierte Ports, die einem Netzsegment verbinden, das eine
andere Bridge günstiger erreichen kann. Sollte diese Bridge ausfallen, kann 
auf den Alternate Port umgeschaltet werden.
\newline
Backup Ports: sind ebenfalls blockiert und verbinden zu einem Segement, das 
ein anderer Port derselben Bridge günstiger erreicht. Von der Software der 
Bridge ist abhängig, ob sie den Backup-Port parralle verwendet, oder lediglich 
bei Ausfall des bevorzugten (designated) Ports.

\subsection{Basiskonfiguration}\label{sw1}
Zunächst wird der Switch konfiguriert. Der Hostname wird zu WTHswitch1 geändert,
das Konsolenpasswort ``cisco'' und das Passwort für den Priviledged EXEC Mode
``class123'' wird konfiguriert. Zur Sicherung der vorgenommenen Einstellungen
wird die running-config in die startup-config kopiert.

\subsection{VLAN Konfiguration}
Die VLANs für die Abteilungen werden nach folgenden Vorgaben konfiguriert:
\begin{table}[!htbp]
\centering
\small
	\begin{tabularx}{1.05\textwidth}{|X|X|X|X|}
	\hline
	\textbf{VLAN Bezeichnung} & \textbf{VLAN Nummer} & \textbf{Subnet} &
	\textbf{Ports}\\
	\hline
	Produktion 	& VLAN10 & 192.168.1.0/24 & 1 - 4 \\
	\hline
	Verwaltung & VLAN20 & 192.168.2.0/24 & 5 - 8 \\
	\hline
	\end{tabularx}
\caption{Konfiguration der VLANs}
\label{configv}
\end{table}

\subsubsection{Erstellen der VLANs}
Die Erstellung erfolgt über das \acs{CLI} des Switchs. Mit \textit{vlan 10} im
Configuration Mode und der anschließenden Eingabe des Namens ist das
entsprechende VLAN erstellt.\footnote{siehe Versuchsanleitung 4.1}
\newline
Durch \textit{show vlan} lässt sich die vorgenommene Konfiguration überprüfen:
\begin{lstlisting}
[...]

10   Produktion                       active    
20   Verwaltung                       active  

[...]
\end{lstlisting}
Alle Ports sind zu diesem Zeitpunkt noch dem Standard-VLAN 1 zugeordnet.
\subsubsection{Zuweisung von Switchports zu den VLANs}
Die Ports können den VLANs entweder einzeln oder mittels Range-Operator
zugeordnet werden. Die Ports 0/1 bis 0/4 werden VLAN 10 zugeordnet. 0/5 bis 0/8
sollen zum VLAN 20 angehören.
\newline
Eine erneute Überprüfung durch \textit{show vlan} zeigt, dass die Zuweisung
erfolgreich war:
\begin{lstlisting}
[...]
10   Produktion                       active    Fa0/1, Fa0/2, Fa0/3, Fa0/4
20   Verwaltung                       active    Fa0/5, Fa0/6, Fa0/7, Fa0/8
[...]
\end{lstlisting}
Auch durch den Befehl \textit{show running-config} lässt sich die Konfiguration
überprüfen.\footnote{siehe Anhang \ref{running-config}}
\subsubsection{Konfiguration überprüfen}
Um die Konfiguration zu testen, werden vier Hosts an den Switch angeschlossen
und wie folgt konfiguriert:

\begin{table}[!htbp]
\centering
\small
	\begin{tabularx}{1.05\textwidth}{|X|X|X|X|X|}
	\hline
	\textbf{Device} & \textbf{VLAN} & \textbf{IP-Address} &
	\textbf{Subnet Mask} & \textbf{Switch Port}\\
	\hline
	PC 1 & VLAN 10 & 192.168.1.10 & 255.255.255.0 & Fa0/1 \\
	\hline
	PC 2 & VLAN 10 & 192.168.1.11 & 255.255.255.0 & Fa0/2 \\
	\hline
	PC 3 & VLAN 20 & 192.168.2.11 & 255.255.255.0 & Fa0/6 \\
	\hline
	PC 4 & VLAN 20 & 192.168.2.10 & 255.255.255.0 & Fa0/5 \\
	\hline
	\end{tabularx}
\caption{Konfiguration der Hosts}
\label{configh}
\end{table}

Anschließend wird mittels Ping-Befehlen die Konfiguration der VLANs getestet.

\begin{itemize}
  \item PC1 zu PC2
  \item PC2 zu PC1
  \item PC3 zu PC4
  \item PC4 zu PC3
\end{itemize}
Die aufgezählten Pings sind erfolgreich, da sich die entprechenden Hosts im
gleichen VLAN befinden.\footnote{siehe Anhang \ref{pingv1}}
\newline
Ein Ping von PC1 zu PC4 ist nicht erfolgreich, da die beiden Computer sich nicht
im selben VLAN befinden. Daraus folgt, dass die
Konfiguration erfolgreich war.

\subsection{Konfigruation des zweiten Switches}%TODO umbenennen
Der zweite Switch wird äquivaelnt zum ersten Switch in \ref{sw1} konfiguriert.
Die Konfiguration unterscheidet sich lediglich beim Hostnamen: WTHswitch2. Da
dieser Versuch mittels PacketTracer durchgeführt wird, lässt sich die
Konfiguration des ersten Switches exportieren und beim zweiten Switch
importieren. Ein Neustart zeigt, dass die Konfiguration erfolgreich war.

\subsection{Trunk Konfiguration}
Die beiden Switchs werden nun verbunden. Um eine Portverschwenudng zu vermeiden
wird ein Trunk konfiguriert. Dafür werden bei beiden Geräten die Ports Fa0/12
verwendet. Die Konfiguration geschieht bei jeweils über das CLI der
Switchs.\footnote{siehe Versuchsanleitung S.19}

\subsubsection{Konfiguration überprüfen}
Zur Überprüfung der Konfiguration wird zunächst das Netzwerk erweitert:
\begin{figure}[ht]
  \centering
     \includegraphics[width=0.8\linewidth]{Graphics/aufbaustep6.PNG}
  \caption{Versuchsaufbau erweitert}
  \label{fig:aufbaustep6}
\end{figure}

Nach dem Aufbau wird die Erreichbarkeit der Hosts mittels Ping-Befehlen
überprüft.\footnote{Auszüge sind in \ref{pings2switchs} zu finden} Pings die
innerhalb eines VLANs durchgeführt werden, sind erfolgreich.
\newline
Pingt man bspw. von PC1 zu PC4, schlägt der Versuch fehl. 
\newline
\newline
Dieses Verhalten ist gewünscht. Die Mitarbeiter der Abteilungen können nur
intern kommunizieren und nicht darüber hinaus.


\subsection{InterVLAN Routing}
%TODO Definition

\subsubsection{Konfiguration des Router}
Durch die Lockerung der Firmenpolitik sollen die Abteilungen auch untereinander
kommunizieren können. Dafür wird ein Router benötigt, der nun konfiguriert wird.
\newline
Der Router erhält den Hostnamen ``WTHrouter1''. Anschließend wird die Fa0/0 wird
aktiviert.
\newline
Für die VLANs werden zwei logische Subinterfaces bei der Schnittstelle Fa0/0
benötigt:
\begin{itemize}
  \item Fa0/0.10: 192.168.1.1/24
  \item Fa0/0.20: 192.168.2.1/24
\end{itemize}
\subsubsection{Verbindung zwischen Router und Switch}
Um den Versuchsaufbau von \ref{fig:aufbau2} zu vervollständigen, wird der der
Router WTHrouter 1 an den Switch WTHsweitch1 (Fa0/9) angeschlossen.
\newline
\newline
Die Standardgateways der Hosts sind zu kontrollieren:
\begin{itemize}
  \item Hosts des VLAN 10: 192.168.1.1
  \item Hosts des VLAN 20: 192.168.2.1
\end{itemize}

\subsection{Analyse der Pakete}
Um die Pakete zu analysieren ist Wireshark zu nutzen. In diesem Fall wird der
Realtime-Modus des PacketTracers genutzt und ICMP-Pakete gefiltert.
\newline
Es wird ein Ping von PC1 zu PC4 gesendet und verfolgt:
%TODO Weg aufzeichnen

