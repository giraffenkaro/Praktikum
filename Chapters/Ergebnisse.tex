\chapter{Beschreibung der verschiedenen Messungen und Ergebnisdarstellung}

\section{Teil 1}


\subsection{Konfiguration der Hosts}\label{hostconfig}
Die Hosts werden nach den Vorgaben in \ref{config1} konfiguriert. Host 1 wird an
den Port Fa0/11 angeschlossen, Host 2 an Fa0/18. Host 3 wird nicht
verbunden.\footnote{siehe Versuchsanleitung S.3}

\subsection{Konfiguration des Router}\label{routerconfig}
Der Router wird an den Port Fa0/5 des Switches angeschlossen und konfiguriert.
Die Konfiguration beinhaltet die Änderung des Hostnames in ``CustomerRouter'',
die Konfiguration und Aktivierung der Passwörter und die Konfiguration der
Fa0/1-Schnittstelle:
\begin{lstlisting}
CustomerRouter(config-if)#line console 0
CustomerRouter(config-line)#password cisco
CustomerRouter(config-line)#login
CustomerRouter(config-line)#exit
CustomerRouter(config)#line vty 0 4
CustomerRouter(config-line)#password cisco
CustomerRouter(config-line)#login
CustomerRouter(config-line)#exit
CustomerRouter(config)#enable password cisco
CustomerRouter(config)#enable secret class
CustomerRouter(config)#exit
\end{lstlisting}

\subsection{Konfiguration des Switch}\label{password}
Die Konfiguration des Switches erfolgt analog zu \ref{routerconfig}. Das
Passwort für den Priviledge EXEC Mode lautet ``cisco123''. Das gleiche Passwort
wird auch für die Konsole und für die \acs{VTY}-Ports (Telnet Ports)
verwendet.\footnote{siehe Versuchsanleitung S.3}

\subsubsection{Konfiguration des VLAN}
Um die Schnittslelle von \acs{VLAN} 1 zu konfigurieren, wird im
Configuration-Mode der Befehl ``\textit{interface vlan 1}'' genutzt. Dann wird die IP-Adresse
(192.168.1.5) und das Default-Gateway (192.168.1.1) konfiguriert.

\subsubsection{Konfiguration überprüfen}
Zunächst wird durch ``\textit{show running-config}'' die aktuelle Konfiguration
ausgegeben.\footnote{Zur Übersichtlichkeit werden die Ausgaben gekürzt und
durch [\ldots] gekennzeichnet}
\begin{lstlisting}
CustomerSwitch#show running-config

[...]

interface Vlan1
 ip address 192.168.1.5 255.255.255.0
!
ip default-gateway 192.168.1.1
!
!
line con 0
 password cisco123
 login
!
line vty 0 4
 password cisco123
 login
line vty 5 15
 password cisco123
 login
!
!
end
\end{lstlisting}
Nach einer Kontrolle wird die Konfiguration durch das
Kopieren der running-config in die startup-config gesichert.
\newline
\newline
Um die Verbindung zu testen, werden Ping- und Telnet-Befehle genutzt.
\begin{itemize}
  	\item Pings
  	\begin{itemize}
    	\item Switch -> Router (192.168.1.1)
    	\item Host 1 -> Switch (192.168.1.5)
    \end{itemize}
\end{itemize}
Beides verlief erfolgreich.\footnote{siehe Anhang \ref{ping1}}

\paragraph{Telnet-Session}\mbox{}\\
Ausgehend von Host 1 eine Telnet-Session zum Switch-Management VLAN 1
eröffnet:

\begin{lstlisting}
PC>telnet 192.168.1.5
Trying 192.168.1.5 ...Open
\end{lstlisting}

Nach Eingabe des zuvor konfigurierten Passworts (cisco123) ist der Zugriff auf
den Switch möglich (User Access Verification). Mit \textit{show version} erhält
man Informationen über die Version der Software des Switches.

\begin{lstlisting}
CustomerSwitch>show version
Cisco IOS Software, C2960 Software (C2960-LANBASE-M), Version 12.2(25)FX, RELEASE SOFTWARE (fc1)
Copyright (c) 1986-2005 by Cisco Systems, Inc.
Compiled Wed 12-Oct-05 22:05 by pt_team

[...]
\end{lstlisting}

Auf dem Switch läuft die Cisco IOS Version 12.2(25)FX.
\newline
\newline
Die vollständige Ausgabe ist im Anhang unter \ref{version} zu finden.

\subsection{MAC-Addressen}

\subsubsection{Hostadressen}\label{adressen}
Um die Layer-2-Adressen der Hosts festzustellen, wird auf jedem Host mit der
Eingabeaufforderung \textit{ipconfig /all} ausgeführt.\footnote{siehe Anhang
\ref{mac}}
\begin{itemize}
  \item Host 1: 0001.C75A.60C4
  \item Host 2: 0090.21A7.1539
  \item Host 3: 0009.7C58.7137
\end{itemize}

\subsubsection{MAC-Adressen-Tabelle}
Mit \textit{show mac-address-table} werden die MAC-Adressen aufgelistet, die dem
Switch zu diesem Zeitpunkt bekannt sind.

\begin{lstlisting}
CustomerSwitch>show mac-address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0001.42a4.0002    DYNAMIC     Fa0/5
   1    0001.c75a.60c4    DYNAMIC     Fa0/11
\end{lstlisting}
Dem Switch sind nur zwei dynamische Adressen bekannt. Die zweite Adresse der
Tabelle entspricht der Adresse von Host 1 am Port Fa0/11.
\newline
\newline
Die erste aufgelistete Adresse entspricht der MAC-Adresse des Routers:
\begin{lstlisting}
CustomerRouter#show interface FastEthernet0/1
FastEthernet0/1 is up, line protocol is up (connected)
  Hardware is Lance, address is 0001.42a4.0002 (bia 0001.42a4.0002)
  Internet address is 192.168.1.1/24
  
  [...]
\end{lstlisting}
\subsubsection{Statische MAC-Adresse}\label{static}
Die aus \ref{adressen} bekannte MAC-Adresse von Host 2 wird nun statisch der
Tabelle des Switches hinzugefügt:

\begin{lstlisting}
CustomerSwitch(config)#mac-address-table static 0090.21A7.1539 vlan 1 interface
fastEthernet 0/18
\end{lstlisting}

Eine erneute Ausgabe der MAC-Adressen-Tabelle zeigt, dass dem Switch nun zwei
Adressen, eine dynamische und eine statische, bekannt sind.

\begin{lstlisting}
CustomerSwitch#show mac-address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0001.42a4.0002    DYNAMIC     Fa0/5
   1    0090.21a7.1539    STATIC      Fa0/18

---------------------------------------------
\end{lstlisting}

Die Adresse von Host 1 wird nicht mehr in der Tabelle aufgeführt. Die Aging-Time
beträgt standardmäßig 300 Sekunden. Nach dieser Zeit wird der Eintrag
gelöscht.\cite{cisco1}

%TODO andere MAC-Adresse?

\subsection{Geschwindigkeit und Duplex}
Zunächst werden die aktuellen Einstellungen der jewiligen Ports mit \textit{show
interfaces} ausgegeben:\footnote{siehe Anhang \ref{duplex}}
\begin{lstlisting}
Full-duplex, 100Mb/s
\end{lstlisting}
Diese Einstellung liegt bei den Ports Fa0/5, Fa0/11 und Fa0/18 vor.

\subsubsection{Änderungen am Port Fa0/5}
Über das \acs{CLI} des Switchs wird nun die Geschwindikeit auf 10Mb/s bei
Half-Duplex geändert.\footnote{siehe Versuchsanleitung S.8}
\newline
Die erneute Ausgabe von \textit{show interfaces} zeigt, dass die Änderung
erfolgreich war:
\begin{lstlisting}
FastEthernet0/5 is up, line protocol is up (connected)
  Hardware is Lance, address is 0002.17c2.8305 (bia 0002.17c2.8305)
 BW 10000 Kbit, DLY 1000 usec,
     reliability 255/255, txload 1/255, rxload 1/255
  Encapsulation ARPA, loopback not set
  Keepalive set (10 sec)
  Half-duplex, 10Mb/s
  
  [...]
\end{lstlisting}
\clearpage

\subsection{Reflection}
\begin{enumerate}
  	\item Welches Passwort muss eingegeben werden, um vom User Mode in den
  	Priviledges EXEC Mode des Switches zu wechseln?
  	\begin{itemize}
    	\item Das zuvor konfigurierte Passwort ``cisco123''. (siehe \ref{password})
  	\end{itemize}
	\item Welches Symbol stellt einen erfolgreichen Ping bei der Cisco IOS Software
	dar?
	\begin{itemize}
	  \item Das Symbol für einen erolfgreichen Ping ist !.
	  \begin{lstlisting}
CustomerSwitch#ping 192.168.1.1

Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.1.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 31/31/32 ms
	  \end{lstlisting}
	\end{itemize}
	\item Welche Vorteile bietet Port Security?
	\begin{itemize}
	  \item Das Anlegen der statischen Route in \ref{static} schützt vor unbefugtem
	  Zugriff. Am Port Fa0/18 darf nur die MAC-Adresse 0090.21A7.1539 (Host 2)
	  senden. Sollte ein anderer Host diesen Port verwenden, wird dies erkannt.
	\end{itemize}
	\item Welche andere portbasierte Sicherheitsmaßnahmen sind möglich?
	\begin{itemize}
	  \item Port Blocking: Standardmäßig sendet ein Switch Pakete mit einer
	  unbekannten Zieladresse an alle Ports. Um dies zu vermeiden ist es möglich,
	  Ports zu blockieren. Durch \textit{switchport block multicast} bzw.
	  \textit{switchport block multicast} wird ein Weiterleiten
	  verhindert.\cite{cisco4}
	  \item Dynamic Secure MAC Addresses: Diese Adressen werden zwar in der
	  MAC-Adressen-Tabelle gespeichert, beim Neustart allerding gelöscht.
	  \item Sticky Secure MAC Addresses: Diese Adressen können entweder
	  konfiguriert oder dynamisch vom Switch erlernt werden. Eine dynamisch
	  erlernte Adresse bleibt auch nach Neustart weiterhin in der
	  Tabelle.\cite{cisco4}
	  \item Aging-Time: Die Aging-Time kann manuell geändert werden, um Adressen
	  aus der Tabelle nach Ablauf eines Timers zu entfernen.\cite{cisco4}
	\end{itemize}
\end{enumerate}

\clearpage

\section{Teil 2}


\subsection{Theorie}

\subsubsection{Einsatz von Switches}
Ein Switch dient dazu mehrere Netzsegmente miteinander zu verbinden. Innerhalb
eines Netzwerks sind Switches für Verteilung, Priorisierung und der Zuweisung
von Datenpaketen (Frames) zu VLANs verantwortlich.\\Im Gegensatz zu Bridges verfügen
Switches über eine Vielzahl von Ports. Alle Ports können unabhängig voneinander
Senden und Empfangen. Für andere Netzwerkgeräte verhält sich ein Switch
transparent.
\newline
Gewöhnliche Switches arbeiten auf Schicht 2 des OSI-Modells. Aus den erhaltenen
Frames wird die MAC-Adresse extrahiert und in der \ac{SAT} gespeichert, ebenso
wie der Port, an dem der Frame eingegangen ist.
\newline
Switches, die über Management-Funktionen verfügen,
werden als Layer-3-Switches bezeichnet. Diese Geräte sind in der Lage die
Aufgaben eines Routers zu übernehmen.

\subsubsection{VLAN}
Durch VLANs, die innerhalb von Switches definiert werden, können physische Netze
in mehrere logische Teilnetze gegliedert werden. Layer-3-Regeln bleiben
unberührt.
VLANs erleichtern die Administration eines Netzwerks und dienen der Sicherheit.
\newline
Die Gliederung erfolgt durch Setzen bzw. Auswerten des VLAN-Tags im
Ethernet-Frame.

\paragraph{Das VLAN-Tag}\mbox{}\\
\label{vlantag}
Beim VLAN-Tag handelt es sich um ein Informationsfeld im Ethernet-Header,
welches 4 Byte Daten zur Verarbeitung von VLAN-Informationen transportiert. Es
besteht aus 3 Bit ``User\_priority''. Weiterhin wird 1 Bit zu
Kompatibilitätszwecken genutzt, um unterschiedliche Bitreihenfolgen bei
\acs{FDDI} \acs{MAC} verarbeiten zu können. Darauf folgen 12 Bit VLAN-ID,
welche zur Adressierung der VLAN genutzt werden können und somit 4096 mögliche Kombinationen
zulässt.\cite{vlan}


\subsubsection{Zuordnung eines Teilnehmers}

Die Zuordnung der Teilnehmer eines VLANs kann auf verschiedene Arten erfolgen:
Switch-Port, MAC-Adresse, Network-Layer Protokoll, verwendete Anwendungen und
verschiedene Kombinationen aus den genannten Kriterien.\cite{diplom}
\newline
Portbasierte VLANs sind eine einfache und weit verbreitete Lösung. 
Die Switch-Ports werden den VLANs zugeordnet und somit auch der angeschlossene
Teilnehmer.\\Bei MAC-basierten VLANs entscheidet der Switch anhand der
Source-Address des Frames, ob eine Weiterleitung stattfindet. Ist die
Quelle dem gleichen VLAN zugeordnet wie das Ziel, wird der Frame an den
entprechenden Port weitergeleitet.\cite{diplom}\cite{vlan}
\newline
Sowohl Port- als auch MAC-basierte VLANs werden vom Administrator statisch
konfiguriert.
\newline
Wenn sich ein VLAN über mehrere Switches erstreckt, kommen Tagged VLANs zum
Einsatz (siehe auch \ref{vlantag}).
\newline
Bei sog. Layer-3-VLANs wird aufgrund des genutzten Protokolls des Teilnehmers
(z.B. IPv4, IPv6) eine Zuordnung getroffen. Nur Anwender, die das gleiche
Protokoll verwenden, befinden sich im selben VLAN.  Möglich ist auch eine
Zuordnung anhand von IP-Subnetzen.\cite{diplom}

\subsubsection{Trunking}
VLANs können sich über mehrere Switches hinweg erstrecken. Um eine
Verbindung zwischen den Switches herzustellen sind VLAN-Trunks eine Möglichkeit
ressourcenschonend die Teilnetze zu verbinden. Dabei werden Ethernet-Frames mit
unterschiedlichen VLAN-Tags über das selbe Kabel transportiert. 

\subsubsection{Spanning Tree Protokoll}\label{stp}

\acs{STP} bezeichnet ein Protokoll zur Pfadoptimierung, das die
Schleifenfreiheit der Netzwerktoplogie gewährleisten soll.\footnote{IEEE 802.1D}

\paragraph{Funktionsweise}\mbox{}\\
Man unterscheidet folgende Port-Zustände bei einem Switch: Disabled, Blocking,
Listening, Learning, Forwarding. Dies beugt einer Schleifenbildung vor, die
bspw. bei einem Übergang von einem blockierten in eines weiterleitenden Zustand,
auftretetn könnte. Die Zustandsänderung wird von drei Timern getriggert:
\begin{itemize}
  \item Hello-Timer: Zeitspanne zwischen \acp{BPDU} (2s)
  \item Forward-Delay: Zeit für die Zustände Learning und Listening (je 15s)
  \item Maximun Age: Dauer, wie lange ein Port die Konfigurationsinformation
  behält (20s)
\end{itemize} 

Zunächst werden alle Ports geblockt. Es findet kein normaler Datenverkehr
statt.
\newline
Im nächsten Schritt wird eine Root-Bridge festgelegt, welche als ``Wurzel'' des
aufgespannten Baumes fungiert. Dazu generiert jeder Switch \acp{BPDU} und sendet
die über alle Ports. \acs{BPDU}s werden zum Austausch von konfigurationsnachrihcten
verwendet und alle zwei Sekunden gesendet. Diese werden von jedem Switch
aktualisiert und weitergeleitet.
\newline
Die Auswahl einer Root-Bridge geschieht mit Hilfe der \acp{BID}. Die BID
ist 8 Bit lang und setzt sich aus 2 Bit Bridge Priority und 6 Bit MAC-Adresse
zusammen. Root-Bridge wird die Bridge mit der niedrigsten Priorität. Nach
Festlegund der Root-Bridge sendet nur noch diese weiterhin BPDUs.
\newline
\newline
Ausgehend von der Root-Bridge werden Pfade festgelegt, über die die anderen
Bridges erreichbar sind. Dazu berechnet jeder Switch Pfadkosten zur Root-Bridge
und aktiviert nur den Port mit den gerigsten Pfadkosten.
\newline
Anschließend befinden sich alle Ports des Roots im Forwarding Modus, ebenso wie
der jeweilige Root Port der Switches. Redundante Pfade (Backup Verbindungen)
werden durch die Deaktivierung des entsprechenden Ports bei der betreffenden
Bridge ausgeschlossen.
\newline
Bei Ausfall eines Pfades wird durch die regelmäßig gesendeten Hello-Messages ein
anderer Port zum Root Port. Bei Ausfall der Root-Bridge wird der ganze Baum neu
organisiert und ein neuer Root festgelegt.
Die initiale Konfiguration dauert ca. 50 Sekunden.\cite{folien}

\clearpage

\subsubsection{Rapid Spanning Tree Protokoll}
\ac{RSTP} ist eine Weiterentwicklung des \acs{STP}. Es zeichnet sich durch eine
deutlich geringere Konfigurationszeit der Switches aus (ca. 6 Sekunden).

\paragraph{Änderungen gegenüber STP}\mbox{}\\
Mit \acs{RSTP} werden neue Port-Zustände und neue Port-Rollen eingeführt.
\newline
Die Zustände bschränken sich auf Discarding, Learning und Forwarding.
Die zusätzlichen Port-Rollen sind:
\begin{itemize}
  \item Alternate: blockierte Ports, die ``nützlichere'' BPDUs anderer
  Bridges auf dem gleichen Segment empfangen
  \item Backup: blockierte Ports, die ``nützlichere'' BPDUs von der gleichen
  Bridge auf dem gleichen Segment empfangen
\end{itemize}
Alternate- und Backup-Ports entsprechen dem Blocking-State bei STP (siehe
\ref{stp}).\cite{rstp}\cite{folien2}
\newline
\newline
Außerdem ändert sich das BPDU-Format und -Handling. Beim Format kommen die
Felder Version und Version 1 Length hinzu. Ebenso ändert sich das Flag und wird
um die Port-Rollen und -Zustände erweitert. 
\newline
Weiterhin werden nur dann BPDUs von Bridges, die nicht die Root-Bridge sind,
generiert, wenn BPDUs am Root-Port empfangen werden. Bei RSTP fungieren die
Hello-Messages als Keep-Alive-Mechanismus. Wenn drei BPDUs in Folge fehlen,
verfällt ein Port-Zustand.\cite{folien2}
\newline
Um eine schnelle Umschaltung gewährleiten uz können, werden Typen für die
Switch-Ports konfiguriert:\cite{rstp}
\begin{itemize}
  \item Edge-Ports
  \item Point-to-Point-Ports
  \item Shared Ports
\end{itemize}


\clearpage
\subsection{Basiskonfiguration}\label{sw1}
Zunächst wird der Switch konfiguriert. Der Hostname wird zu WTHswitch1 geändert,
das Konsolenpasswort ``cisco'' und das Passwort für den Priviledged EXEC Mode
``class123'' wird konfiguriert. Zur Sicherung der vorgenommenen Einstellungen
wird die running-config in die startup-config kopiert.

\clearpage
\subsection{VLAN Konfiguration}
Die VLANs für die Abteilungen werden nach folgenden Vorgaben konfiguriert:
\begin{table}[!htbp]
\centering
\small
	\begin{tabularx}{1.05\textwidth}{|X|X|X|X|}
	\hline
	\textbf{VLAN Bezeichnung} & \textbf{VLAN Nummer} & \textbf{Subnet} &
	\textbf{Ports}\\
	\hline
	Produktion 	& VLAN10 & 192.168.1.0/24 & 1 - 4 \\
	\hline
	Verwaltung & VLAN20 & 192.168.2.0/24 & 5 - 8 \\
	\hline
	\end{tabularx}
\caption{Konfiguration der VLANs}
\label{configv}
\end{table}


\subsubsection{Erstellen der VLANs}
Die Erstellung erfolgt über das \acs{CLI} des Switchs. Mit \textit{vlan 10} im
Configuration Mode und der anschließenden Eingabe des Namens ist das
entsprechende VLAN erstellt.\footnote{siehe Versuchsanleitung 4.1}
\newline
Durch \textit{show vlan} lässt sich die vorgenommene Konfiguration überprüfen:
\begin{lstlisting}
[...]

10   Produktion                       active    
20   Verwaltung                       active  

[...]
\end{lstlisting}
Alle Ports sind zu diesem Zeitpunkt noch dem Defaukt-VLAN 1 zugeordnet.
\subsubsection{Zuweisung von Switchports zu den VLANs}
Die Ports können den VLANs entweder einzeln oder mittels Range-Operator
zugeordnet werden. Die Ports 0/1 bis 0/4 werden VLAN 10 zugeordnet. 0/5 bis 0/8
sollen zum VLAN 20 angehören.
\newline
Eine erneute Überprüfung durch \textit{show vlan} zeigt, dass die Zuweisung
erfolgreich war:
\begin{lstlisting}
[...]
10   Produktion                       active    Fa0/1, Fa0/2, Fa0/3, Fa0/4
20   Verwaltung                       active    Fa0/5, Fa0/6, Fa0/7, Fa0/8
[...]
\end{lstlisting}
Auch durch den Befehl \textit{show running-config} lässt sich die Konfiguration
überprüfen.\footnote{siehe Anhang \ref{running-config}}
\clearpage

\subsubsection{Konfiguration überprüfen}
Um die Konfiguration zu testen, werden vier Hosts an den Switch angeschlossen
und wie folgt konfiguriert:

\begin{table}[!htbp]
\centering
\small
	\begin{tabularx}{1.05\textwidth}{|X|X|X|X|X|}
	\hline
	\textbf{Device} & \textbf{VLAN} & \textbf{IP-Address} &
	\textbf{Subnet Mask} & \textbf{Switch Port}\\
	\hline
	PC 1 & VLAN 10 & 192.168.1.10 & 255.255.255.0 & Fa0/1 \\
	\hline
	PC 2 & VLAN 10 & 192.168.1.11 & 255.255.255.0 & Fa0/2 \\
	\hline
	PC 3 & VLAN 20 & 192.168.2.11 & 255.255.255.0 & Fa0/6 \\
	\hline
	PC 4 & VLAN 20 & 192.168.2.10 & 255.255.255.0 & Fa0/5 \\
	\hline
	\end{tabularx}
\caption{Konfiguration der Hosts}
\label{configh}
\end{table}

Anschließend wird mittels Ping-Befehlen die Konfiguration der VLANs getestet.

\begin{itemize}
  \item PC1 zu PC2
  \item PC2 zu PC1
  \item PC3 zu PC4
  \item PC4 zu PC3
\end{itemize}
Die aufgezählten Pings sind erfolgreich, da sich die entprechenden Hosts im
gleichen VLAN befinden.\footnote{siehe Anhang \ref{pingv1}}
\newline
Ein Ping von PC1 zu PC4 ist nicht erfolgreich, da die beiden Computer sich nicht
im selben VLAN befinden. Daraus folgt, dass die
Konfiguration erfolgreich war.

\subsection{Konfigruation des zweiten Switches}%TODO umbenennen
Der zweite Switch wird äquivalent zum ersten Switch in \ref{sw1} konfiguriert.
Die Konfiguration unterscheidet sich lediglich beim Hostnamen: WTHswitch2. Da
dieser Versuch mittels PacketTracer durchgeführt wird, lässt sich die
Konfiguration des ersten Switches exportieren und beim zweiten Switch
importieren. Ein Neustart zeigt, dass die Konfiguration erfolgreich war.

\clearpage
\subsection{Trunk Konfiguration}
Die beiden Switchs werden nun verbunden. Um eine Portverschwenudng zu vermeiden
wird ein Trunk konfiguriert. Dafür werden bei beiden Geräten die Ports Fa0/12
verwendet. Die Konfiguration geschieht bei jeweils über das CLI der
Switchs.\footnote{siehe Versuchsanleitung S.19}

\subsubsection{Konfiguration überprüfen}
Zur Überprüfung der Konfiguration wird zunächst das Netzwerk erweitert:
\begin{figure}[ht]
  \centering
     \includegraphics[width=0.8\linewidth]{Graphics/aufbaustep6.PNG}
  \caption{Versuchsaufbau erweitert}
  \label{fig:aufbaustep6}
\end{figure}

Nach dem Aufbau wird die Erreichbarkeit der Hosts mittels Ping-Befehlen
überprüft.\footnote{Auszüge sind in \ref{pings2switchs} zu finden} Pings die
innerhalb eines VLANs durchgeführt werden, sind erfolgreich.
\newline
Pingt man bspw. von PC1 zu PC4, schlägt der Versuch fehl. 
\newline
\newline
Dieses Verhalten ist gewünscht. Die Mitarbeiter der Abteilungen können nur
intern kommunizieren und nicht darüber hinaus.


\subsection{InterVLAN Routing}
InterVlan Routing ist erforderlich, wenn die Hosts an einem Switch
unterschiedlichen IP-Netzen angehören. Es ist notwendig verschiedene
Adressbereiche zu den VLANs zu defiieren.\cite{folien}
\newline
Wenn unterschiedliche VLANs miteinander kommunizieren wollen, muss
eine Verbindung der VLANs zu einem Router bestehen. Dies wird durch eine
Verbinung vom Switch zum Router realisiert.

\subsubsection{Konfiguration des Router}
Durch die Lockerung der Firmenpolitik sollen die Abteilungen auch untereinander
kommunizieren können. Dafür wird ein Router benötigt, der nun konfiguriert wird.
\newline
Der Router erhält den Hostnamen ``WTHrouter1''. Anschließend wird die Fa0/0 wird
aktiviert.
\newline
Für die VLANs werden zwei logische Subinterfaces bei der Schnittstelle Fa0/0
benötigt:
\begin{itemize}
  \item Fa0/0.10: 192.168.1.1/24
  \item Fa0/0.20: 192.168.2.1/24
\end{itemize}
\subsubsection{Verbindung zwischen Router und Switch}
Um den Versuchsaufbau von \ref{fig:aufbau2} zu vervollständigen, wird der der
Router WTHrouter 1 an den Switch WTHsweitch1 (Fa0/9) angeschlossen.
\newline
\newline
Die Standardgateways der Hosts sind zu kontrollieren:
\begin{itemize}
  \item Hosts des VLAN 10: 192.168.1.1
  \item Hosts des VLAN 20: 192.168.2.1
\end{itemize}

\subsection{Analyse der Pakete}

Zunächst ist mittels Ping-Befehlen zu verifizieren, dass alle Computer
erreichbar sind, auch die, die sich nicht im gleichen VLAN befinden. Alle
Befehle sind erfolgreich.\footnote{Unter \ref{pingstep8} sind die Ping-Befehle
außerhalb des eigenen VLANs zu finden.}

\subsubsection{Analyse eines Ping-Befehls}

Der Weg, den ein Ping von PC1 zu PC4 nimmt, wird aufgezeichnet und analysiert.
Hierzu ist Wireshark zu verwenden. Da dieser Laborversuch mit dem Cisco
PacketTracer durchgeführt wurde, wird stattdessen der Simulation-Mode zur
Aufzeichnung genutzt. 
\newline
Die Tabelle \ref{pingroute} zeigt den zeitlichen Ablauf des Wegs, den der Ping
nimmt:

\begin{table}[!htbp]
\centering
\small
	\begin{tabularx}{1.05\textwidth}{|X|X|X|}
	\hline
	\textbf{Zeit} & \textbf{Quelle} & \textbf{Ziel} \\
	\hline
	0.000 & --- & PC1 \\
	\hline
	0.001 & PC1 & WTHswitch1 \\
	\hline
	0.002 & WTHswitch1 & WTHrouter1 \\
	\hline
	0.003 & WTHrouter1 & WTHswitch1 \\
	\hline
	0.004 & WTHswitch1 & WTHswitch2 \\
	\hline
	0.005 & WTHswitch2 & PC4 \\
	\hline
	0.006 & PC4 & WTHswitch2 \\
	\hline
	0.007 & WTHswitch2 & WTHswitch1 \\
	\hline
	0.008 & WTHswitch1 & WTHrouter1 \\
	\hline
	0.009 & WTHrouter1 & WTHswitch1 \\
	\hline
	0.010 & WTHswitch1 & PC1 \\
	\hline
	\end{tabularx}
\caption{Weg eines Pings von PC1 zu PC4}
\label{pingroute}
\end{table}
PC 1 sendet ein Echo Request an WTHswitch1, welcher dieser an WTHrouter1
weiterleitet. Von dort wird Anfrage zurück an den WTHswitch 1 geleitet.
Im Anschluss wird die Anfrage an WTHswitch2 weitergeleitet. WTHswitch 2
erreicht im nächsten Schritt sein Ziel.
\newline
Der Echo Reply gelangt auf dem gleichen Weg zurück.
\clearpage
\paragraph{Analyse der OSI-Layer 2 und 3}\mbox{}\\

Zum Zeitpunkt 0.000 
